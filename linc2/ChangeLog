2001-09-09  Michael Meeks  <michael@ximian.com>

	* src/linc-server.c (linc_server_setup): remove
	bogus g_free (saddr)

2001-09-07  Mark McLoughlin <mark@skynet.ie>

	* acconfig.h, configure.in: add check for
        sockaddr's sa_len member.

	* src/linc-protocols.c(linc_protocol_get_sockaddr,
        linc_protocol_get_sockaddr_ipv4,
        linc_protocol_get_sockaddr_ipv6,
        linc_protocol_get_sockaddr_unix,
        linc_protocol_get_sockaddr_irda): impl. get_sockaddr
        will replace getaddrinfo soon. getaddrinfo is a waste
        of time - we don't need most of the data it returns,
        and it is non-portable for unix sockets, ipv6 and irda.
        Indeed older unices don't even have an implementation for 
        ipv4.
	*NOTE*: irda and ipv6 are not working with this yet. But
	        I doubt anyone is actually using these...

	* src/linc-private.h: add linc_protocol_get_sockaddr.

	* src/linc-connection.c(linc_connection_initiate): use
        linc_protocol_get_sockaddr instead of linc_getaddrinfo.

	* src/linc-server.c(linc_server_setup): ditto.

	* include/linc/linc-types.h: moved LINCProtocolInfo here.

	* include/linc/linc-protocol.h
        (LINCProtocolInfo): added get_sockname. Impl typedefs
        for functions types.

2001-09-07  Mark McLoughlin <mark@skynet.ie>

	* src/linc-protocols.c: Warning killers - include string.h
	and don't prototype IRDA functions if IRDA defines not
	available.

2001-08-31  Michael Meeks  <michael@ximian.com>

	* src/linc-connection.c (ERR_CONDS): hack off G_IO_PRI
	(IN_CONDS): PRI|IN
	(linc_connection_connected),
	(linc_connection_real_state_changed): use it.

2001-08-27  Mark McLoughlin <mark@skynet.ie>

	* linc.pc.in: require gobject and gthread.

2001-08-24  Mark McLoughlin <mark@skynet.ie>
	
	* configure.in: remove unused --enable-linc-threadsafe
	option. Removed pthread.h check - we always want to
	link against gthread.

2001-08-23  Michael Meeks  <michael@ximian.com>

	* Version 0.1.4

2001-08-21 Dirk-Jan C. Binnema <djcb@djcbsoftware.nl>

	* src/linc.c (main): ignore SIGPIPE, handle this
	here instead of in libbonobo

2001-08-20  Theo van Klaveren  <t.vanklaveren@student.utwente.nl>

	* include/linc/linc-protocol.h: Include <sys/types.h> to
	fix build on FreeBSD.

2001-08-18  Cody Russell  <bratsche@gnome.org>

	* linc.pc.in: Added.

	* configure.in, Makefile.am: Build and install linc.pc

2001-08-18  Michael Meeks  <michael@ximian.com>

	* configure.in: bump version to 0.1.3

	* src/linc.c (linc_mutex_attrs): kill.
	(linc_init): kill pthread specific bits, take
	gboolean 'init_threads'
	(linc_mutex_new): impl. to hide conditional mess.

	* src/linc-server.c (linc_server_accept_connection):
	split out of
	(linc_server_handle_io): here & update locking.

2001-08-17  Michael Meeks  <michael@ximian.com>

	* src/linc-server.c (linc_server_init): use g_thread
	stuff straight - no need for a recursive mutex - set
	to NULL if threads not initialized.

	* include/linc: homogenise header guard style, add
	G_BEGIN/END_DECLS

	* include/linc/linc-types.h:
	s/LINC_THREADSAFE/G_THREADS_ENABLED/ kill whacked out
	threading macro overload.
	(LINC_MUTEX_[UN]LOCK): don't inexplicably steal
	chunks of the O_ namespace.
	kill extreme strangeness with defining wierd system bits.

	* Revert Mark's patch.

2001-08-18  Mark McLoughlin <mark@skynet.ie>

	* configure.in: added --enable-linc-threadsafe
	option. Defaults to yes.

	* include/linc/linc-config.h.in: added
	LINC_ENABLE_THREADSAFE def.

	* include/linc/linc-connection.h,
	  include/linc/linc-server.h,
	  include/linc/linc-server.h,
	  include/linc/linc-types.h,
	  include/linc/linc-threads.h,
	  include/linc/linc.h: split out threaded
	stuff into linc-threads.h. Removed _GNU_SOURCE,
	_XOPEN_SOURCE and _REENTRANT defines. Cleaned
	up a little.

	* linc/include/linc/Makefile.am: added linc-threads.h.

	* src/Makefile.am: add -D_GNU_SOURCE for
	PTHREAD_MUTEX_RECURSIVE.

2001-08-16  Mark McLoughlin <mark@skynet.ie>

	* configure.in: Cache ACLOCAL_FLAGS.

2001-08-16  Michael Meeks  <michael@ximian.com>

	* configure.in: bump version to 0.1.2

	* src/linc-connection.c (linc_connection_get_type): don't
	use the base_init - but the instance_init to set fd == -1
	so we don't close (0), doh.
	(linc_connection_connected): update to call the
	handle_input virtual method on input.

2001-08-14  Michael Meeks  <michael@ximian.com>

	* src/linc-protocols.c (irda_getaddrinfo): kill another
	heinous srand idiocy.

2001-08-13  Michael Meeks  <michael@ximian.com>

	* src/linc-connection.c (linc_close_fd): split out.
	(linc_connection_dispose): use.
	(linc_connection_real_state_changed): ditto.

2001-08-13  Michael Meeks  <michael@ximian.com>

	* src/linc-connection.c (linc_connection_init): impl,
	to init cnx->fd = -1.
	(linc_connection_get_type): upd. - thanks to Martin Baulig.

2001-08-10  Michael Meeks  <michael@ximian.com>

	* src/linc-protocols.c (linc_set_tmpdir): kill gratuitous evil
	(make_local_tmpdir): copy from ORBit-stable.
	(linc_set_tmpdir): actualy ensure that we have a valid
	working directory.

2001-07-30  Michael Meeks  <michael@ximian.com>

	* Version 0.1.1

2001-07-30  Michael Meeks  <michael@ximian.com>

	* src/linc-connection.c (linc_connection_class_init):
	remove redundant static prototypes.
	(linc_connection_class_init): init 'broken' signal.
	(linc_connection_real_state_changed): emit the 'broken'
	signal.

2001-07-24  Michael Meeks  <michael@ximian.com>

	* src/linc-connection.c (linc_connection_real_state_changed): 
	make it unref the connection on disconnect ...

2001-07-18  Michael Meeks  <michael@ximian.com>

	* src/linc-connection.c (linc_connection_writev):
	s/g_main_iteration/linc_main_iteration/.

	* src/linc.c (linc_main_iteration): impl.
	(linc_init): make the linc_loop run.
	(linc_main_pending): impl.
	(linc_main_loop_run): impl.

	* src/linc-server.c (linc_server_dispose): upd.
	(linc_server_setup): upd.
	(linc_server_get_type): re-order to kill redundant
	prototypes.

	* src/linc-connection.c (linc_source_remove): upd.
	(linc_connection_init): remove; redundant.
	(linc_connection_real_state_changed): upd.
	(linc_connection_connected): upd.

	* src/linc.c (linc_io_add_watch): impl.
	(linc_io_remove_watch): impl.

	* include/linc/linc-types.h: add LincWatch type.

	* src/*.c: s/g_io_add_watch/linc_io_add_watch/

2001-07-16  Darin Adler  <darin@bentspoon.com>

	* include/linc/linc-types.h: Fix order of includes to
	keep Linux happy -- the Solaris change let to a compile
	failure on Linux.

	* src/linc.c: (linc_init): Add a missing ifdef.

2001-07-16  Laszlo Peter  <laca@ireland.sun.com>

	* src/linc-protocols.c: set fakelen to 0 when fakehost is NULL
        to avoid core dump on Solaris.

	* include/linc/linc-types.h: include <sys/types.h> to
	keep Solaris happy.

2001-07-13  Darin Adler  <darin@bentspoon.com>

	* configure.in: Remove duplicate macros, and fix one of
	the test invocations that was not using the x prefix
	technique correctly.

2001-07-13  Michael Meeks  <michael@ximian.com>

	* src/linc-connection.c (linc_connection_initiate): add
	more error checking on fcntls.

2001-07-08  Seth Nickell  <snickell@stanford.edu>

	* src/linc.c: (linc_init):

	Only call g_thread_init if the threading system hasn't
	already been activated.

2001-07-03  Michael Meeks  <michael@ximian.com>

	* src/linc-protocols.c (linc_getaddrinfo): don't re-seed the
	random number generator with the time in seconds !
	don't use "%d%d", rand (), rand () - it gains us nothing,
	add gettimeofday ^ instead.

	* src/linc-connection.c (linc_connection_dispose):
	s/shutdown/dispose.

	* src/linc.c (linc_init): fix g_type_init.

2001-07-02  Michael Meeks  <michael@ximian.com>

	* src/linc-server.c (linc_server_setup): regenerate the
	UDS' name on EINVAL from bind.

2001-06-21  Martin Baulig  <baulig@suse.de>

	* configure.in: Make this work if SSL is not installed.

2001-05-25  Michael Meeks  <michael@ximian.com>

	* src/linc-connection.c (linc_source_remove): split from
	(linc_connection_shutdown): here, and release the self
	reference whilst watching.
	(linc_connection_real_state_changed): use linc_source_remove.
	(linc_connection_connected): hold a ref over the state_changed
	emissions.

2001-05-24  Michael Meeks  <michael@ximian.com>

	* src/linc-connection.c (linc_connection_connected):
	unref the connection object on disconnection.

	* src/linc-server.c (linc_server_destroy):
	protect against multiple shutdowns, and rename to

	* src/linc-connection.c (linc_connection_destroy): 
	protect against multiple shutdowns, and rename to
	(linc_connection_shutdown): this.
	(linc_connection_real_state_changed): add assertions
	on source removal.

2001-05-18  Michael Meeks  <michael@ximian.com>

	* src/linc-connection.c (linc_connection_destroy): check
	the io channel is valid before the unref - happens in
	some error cases.

2001-05-18  Michael Meeks  <michael@ximian.com>

	* src/linc-server.c (linc_server_class_init): actualy
	make the signal run.

2001-05-18  Michael Meeks  <michael@ximian.com>

	* autogen.sh: update for libtool 1.4

	* src/linc-connection.c (linc_connection_destroy): unref
	the IO channel on destroy - doh.

2000-10-27  Michael Meeks  <michael@helixcode.com>

	* src/linc-server.c (linc_server_get_type): type_register_static
	fix.

	* src/linc-connection.c (linc_connection_writev): use cnx->fd.
	(linc_connection_get_type): add '0' parameter for head glib.

